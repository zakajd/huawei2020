[09-19 08:17] - Parameters used for training: Namespace(arch='genet_small', augmentation='hard', batch_size=64, config_file='configs/2_genet_small_finetune.yaml', criterion='arcface', criterion_params={'out_features': 3097, 's': 80.0, 'm': 1.0}, debug=False, ema_decay=0.0, embedding_size=512, freeze_bn=False, model_params={}, name='genet_small_512_light_arcface80_1', optim='adamw', outdir='logs/genet_small_512_light_arcface80_1', phases=[{'ep': [0, 25], 'lr': [0.001, 1e-05]}], pooling='gem', resume='logs/genet_small_384_light_arcface80_1/model.chpn', root='data/interim', seed=42, size=512, tta=False, use_fp16=True, val_frequency=1, val_size=768, weight_decay=1e-05, workers=8)
[09-19 08:17] - Model size: 7.24M
[09-19 08:17] - Loss for this run is: AdditiveAngularMarginLoss(
  (criterion): CrossEntropyLoss()
)
[09-19 08:17] - Using sizes {(1024, 512), (512, 1024), (512, 680), (512, 768), (512, 512), (512, 640), (640, 512), (768, 512), (680, 512), (904, 512), (512, 904)} for train
[09-19 08:17] - Using sizes {(1024, 768), (1152, 768), (768, 1024), (960, 768), (768, 768), (768, 1536), (768, 1152), (1536, 768), (768, 960), (768, 1360), (1360, 768)} for validation
[09-19 08:17] - Val size: 20428
[09-19 08:17] - Train size: 48173
[09-19 08:17] - Start training
[09-19 08:17] - Start phase #1 from epoch 0 to epoch 25: {'ep': [0, 25], 'lr': [0.001, 1e-05], 'mom': [], 'mode': 'linear'}
[09-19 08:17] - Epoch 1 | lr 0.00e+00
[09-19 08:23] - 
TimeMeter profiling. Data time: 7.30E-04s. Model time: 4.69E-01s 

[09-19 08:26] - Train loss: 40.6398 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 08:26] - Val   loss: 94.0020 | Acc@1: 0.8424 | mAP@10: 0.8251 | target: 0.8338 | mAP@R: 0.8017
[09-19 08:26] - Epoch  1: best target improved from -inf to 0.8338
[09-19 08:26] - Epoch  1: best mAP@R improved from -inf to 0.8017
[09-19 08:26] - Epoch 2 | lr 9.64e-04
[09-19 08:35] - Train loss: 37.9926 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 08:35] - Val   loss: 93.9907 | Acc@1: 0.8413 | mAP@10: 0.8287 | target: 0.8350 | mAP@R: 0.8053
[09-19 08:35] - Epoch  2: best target improved from 0.8338 to 0.8350
[09-19 08:35] - Epoch  2: best mAP@R improved from 0.8017 to 0.8053
[09-19 08:35] - Epoch 3 | lr 9.24e-04
[09-19 08:44] - Train loss: 36.4335 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 08:44] - Val   loss: 94.7409 | Acc@1: 0.8380 | mAP@10: 0.8268 | target: 0.8324 | mAP@R: 0.8022
[09-19 08:44] - Epoch 4 | lr 8.84e-04
[09-19 08:53] - Train loss: 35.1960 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 08:53] - Val   loss: 94.7268 | Acc@1: 0.8451 | mAP@10: 0.8314 | target: 0.8383 | mAP@R: 0.8072
[09-19 08:53] - Epoch  4: best target improved from 0.8350 to 0.8383
[09-19 08:53] - Epoch  4: best mAP@R improved from 0.8053 to 0.8072
[09-19 08:53] - Epoch 5 | lr 8.45e-04
[09-19 09:02] - Train loss: 34.3828 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 09:02] - Val   loss: 94.9820 | Acc@1: 0.8516 | mAP@10: 0.8387 | target: 0.8452 | mAP@R: 0.8149
[09-19 09:02] - Epoch  5: best target improved from 0.8383 to 0.8452
[09-19 09:02] - Epoch  5: best mAP@R improved from 0.8072 to 0.8149
[09-19 09:02] - Epoch 6 | lr 8.05e-04
[09-19 09:11] - Train loss: 33.4961 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 09:11] - Val   loss: 95.3446 | Acc@1: 0.8527 | mAP@10: 0.8375 | target: 0.8451 | mAP@R: 0.8147
[09-19 09:11] - Epoch 7 | lr 7.66e-04
[09-19 09:20] - Train loss: 33.0153 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 09:20] - Val   loss: 95.1608 | Acc@1: 0.8511 | mAP@10: 0.8345 | target: 0.8428 | mAP@R: 0.8105
[09-19 09:20] - Epoch 8 | lr 7.26e-04
[09-19 09:28] - Train loss: 32.3734 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 09:28] - Val   loss: 95.3587 | Acc@1: 0.8565 | mAP@10: 0.8371 | target: 0.8468 | mAP@R: 0.8138
[09-19 09:28] - Epoch  8: best target improved from 0.8452 to 0.8468
[09-19 09:28] - Epoch 9 | lr 6.86e-04
[09-19 09:37] - Train loss: 32.0230 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 09:37] - Val   loss: 95.4928 | Acc@1: 0.8565 | mAP@10: 0.8396 | target: 0.8481 | mAP@R: 0.8158
[09-19 09:37] - Epoch  9: best target improved from 0.8468 to 0.8481
[09-19 09:37] - Epoch  9: best mAP@R improved from 0.8149 to 0.8158
[09-19 09:37] - Epoch 10 | lr 6.47e-04
[09-19 09:46] - Train loss: 31.6066 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 09:46] - Val   loss: 95.6004 | Acc@1: 0.8554 | mAP@10: 0.8363 | target: 0.8459 | mAP@R: 0.8143
[09-19 09:46] - Epoch 11 | lr 6.07e-04
[09-19 09:54] - Train loss: 31.2488 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 09:54] - Val   loss: 95.7279 | Acc@1: 0.8549 | mAP@10: 0.8360 | target: 0.8454 | mAP@R: 0.8136
[09-19 09:54] - Epoch 12 | lr 5.68e-04
[09-19 10:03] - Train loss: 30.8732 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 10:03] - Val   loss: 95.5122 | Acc@1: 0.8538 | mAP@10: 0.8416 | target: 0.8477 | mAP@R: 0.8192
[09-19 10:03] - Epoch 12: best mAP@R improved from 0.8158 to 0.8192
[09-19 10:03] - Epoch 13 | lr 5.28e-04
[09-19 10:12] - Train loss: 30.5759 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 10:12] - Val   loss: 95.7784 | Acc@1: 0.8554 | mAP@10: 0.8395 | target: 0.8475 | mAP@R: 0.8168
[09-19 10:12] - Epoch 14 | lr 4.88e-04
[09-19 10:20] - Train loss: 30.4826 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 10:20] - Val   loss: 95.9480 | Acc@1: 0.8554 | mAP@10: 0.8387 | target: 0.8471 | mAP@R: 0.8166
[09-19 10:20] - Epoch 15 | lr 4.49e-04
[09-19 10:29] - Train loss: 30.2665 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 10:29] - Val   loss: 95.9018 | Acc@1: 0.8592 | mAP@10: 0.8402 | target: 0.8497 | mAP@R: 0.8179
[09-19 10:29] - Epoch 15: best target improved from 0.8481 to 0.8497
[09-19 10:29] - Epoch 16 | lr 4.09e-04
[09-19 10:38] - Train loss: 30.0131 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 10:38] - Val   loss: 96.0349 | Acc@1: 0.8609 | mAP@10: 0.8424 | target: 0.8516 | mAP@R: 0.8184
[09-19 10:38] - Epoch 16: best target improved from 0.8497 to 0.8516
[09-19 10:38] - Epoch 17 | lr 3.70e-04
[09-19 10:47] - Train loss: 29.8531 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 10:47] - Val   loss: 95.9406 | Acc@1: 0.8565 | mAP@10: 0.8410 | target: 0.8488 | mAP@R: 0.8170
[09-19 10:47] - Epoch 18 | lr 3.30e-04
[09-19 10:55] - Train loss: 29.7469 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 10:55] - Val   loss: 96.0391 | Acc@1: 0.8554 | mAP@10: 0.8381 | target: 0.8468 | mAP@R: 0.8141
[09-19 10:55] - Epoch 19 | lr 2.90e-04
[09-19 11:04] - Train loss: 29.5766 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 11:04] - Val   loss: 96.0047 | Acc@1: 0.8587 | mAP@10: 0.8418 | target: 0.8502 | mAP@R: 0.8172
[09-19 11:04] - Epoch 20 | lr 2.51e-04
[09-19 11:13] - Train loss: 29.4659 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 11:13] - Val   loss: 96.1039 | Acc@1: 0.8565 | mAP@10: 0.8407 | target: 0.8486 | mAP@R: 0.8161
[09-19 11:13] - Epoch 21 | lr 2.11e-04
[09-19 11:21] - Train loss: 29.3560 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 11:21] - Val   loss: 96.1093 | Acc@1: 0.8554 | mAP@10: 0.8402 | target: 0.8478 | mAP@R: 0.8169
[09-19 11:21] - Epoch 22 | lr 1.72e-04
[09-19 11:30] - Train loss: 29.2727 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 11:30] - Val   loss: 96.1407 | Acc@1: 0.8565 | mAP@10: 0.8410 | target: 0.8487 | mAP@R: 0.8177
[09-19 11:30] - Epoch 23 | lr 1.32e-04
[09-19 11:40] - Train loss: 29.2041 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 11:40] - Val   loss: 96.1081 | Acc@1: 0.8571 | mAP@10: 0.8417 | target: 0.8494 | mAP@R: 0.8182
[09-19 11:40] - Epoch 24 | lr 9.24e-05
[09-19 11:49] - Train loss: 29.1442 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 11:49] - Val   loss: 96.1927 | Acc@1: 0.8592 | mAP@10: 0.8425 | target: 0.8509 | mAP@R: 0.8186
[09-19 11:49] - Epoch 25 | lr 5.28e-05
[09-19 11:57] - Train loss: 29.0908 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 11:57] - Val   loss: 96.1676 | Acc@1: 0.8587 | mAP@10: 0.8417 | target: 0.8502 | mAP@R: 0.8177
[09-19 11:57] - Loading best model from previous phase
[09-19 12:00] - Val: Acc@1 0.86087, mAP@10 0.84243, Target 0.85165, mAP@R 0.81844
[09-19 12:00] - Finished Training. Took: 223.14m
