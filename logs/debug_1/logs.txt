[09-19 01:59] - Parameters used for training: Namespace(arch='genet_small', augmentation='light', batch_size=128, config_file='configs/genet_small.yaml', criterion='arcface', criterion_params={'out_features': 3097, 's': 64.0, 'm': 0.5}, debug=False, ema_decay=0.0, embedding_size=512, freeze_bn=False, model_params={}, name='debug', optim='adamw', outdir='logs/debug', phases=[{'ep': [0, 3], 'lr': [0.1, 0.01]}], pooling='gem', resume='', root='data/interim', seed=42, size=384, tta=False, use_fp16=True, val_frequency=1, val_size=512, weight_decay=1e-05, workers=6)
[09-19 01:59] - Model size: 7.24M
[09-19 01:59] - Loss for this run is: AdditiveAngularMarginLoss(
  (criterion): CrossEntropyLoss()
)
[09-19 02:00] - Using sizes {(384, 768), (384, 512), (768, 384), (512, 384), (384, 576), (384, 384), (384, 480), (480, 384), (680, 384), (576, 384), (384, 680)} for train
[09-19 02:00] - Using sizes {(768, 512), (512, 512), (640, 512), (512, 1024), (512, 768), (1024, 512), (512, 640), (680, 512), (904, 512), (512, 904), (512, 680)} for validation
[09-19 02:00] - Val size: 20428
[09-19 02:00] - Train size: 48173
[09-19 02:00] - Start training
[09-19 02:00] - Start phase #1 from epoch 0 to epoch 3: {'ep': [0, 3], 'lr': [0.1, 0.01], 'mom': [], 'mode': 'linear'}
[09-19 02:00] - Epoch 1 | lr 0.00e+00
[09-19 02:02] - 
TimeMeter profiling. Data time: 8.34E-04s. Model time: 3.00E-01s 

[09-19 02:03] - Train loss: 39.7898 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 02:03] - Val   loss: 41.0429 | Acc@1: 0.2582 | mAP@10: 0.2987 | target: 0.2784 | mAP@R: 0.2698
[09-19 02:03] - Epoch  1: best target improved from -inf to 0.2784
[09-19 02:03] - Epoch  1: best mAP@R improved from -inf to 0.2698
[09-19 02:03] - Epoch 2 | lr 7.31e-02
[09-19 02:06] - Train loss: 36.4633 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 02:06] - Val   loss: 42.4770 | Acc@1: 0.5777 | mAP@10: 0.5787 | target: 0.5782 | mAP@R: 0.5416
[09-19 02:06] - Epoch  2: best target improved from 0.2784 to 0.5782
[09-19 02:06] - Epoch  2: best mAP@R improved from 0.2698 to 0.5416
[09-19 02:06] - Epoch 3 | lr 4.31e-02
[09-19 02:09] - Train loss: 32.6269 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-19 02:09] - Val   loss: 44.0466 | Acc@1: 0.6842 | mAP@10: 0.6794 | target: 0.6818 | mAP@R: 0.6453
[09-19 02:09] - Epoch  3: best target improved from 0.5782 to 0.6818
[09-19 02:09] - Epoch  3: best mAP@R improved from 0.5416 to 0.6453
[09-19 02:09] - Loading best model from previous phase
[09-19 02:10] - Val: Acc@1 0.68424, mAP@10 0.67938, Target 0.68181, mAP@R 0.64531
[09-19 02:10] - Finished Training. Took: 10.93m
