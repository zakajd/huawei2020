[09-18 09:56] - Parameters used for training: Namespace(arch='genet_normal', augmentation='hard', batch_size=64, config_file='configs/tmp/genet_gem3.yaml', criterion='arcface', criterion_params={'out_features': 3097, 's': 64.0, 'm': 0.5}, debug=False, ema_decay=0.0, embedding_size=512, model_params={}, name='genet_512_arcface_05_gem_hard', optim='adamw', outdir='logs/genet_512_arcface_05_gem_hard', phases=[{'ep': [0, 30], 'lr': [0.1, 0.005]}, {'ep': [30, 50], 'lr': [0.005, 0.0001]}], pooling='gem', resume='', root='data/interim', seed=42, size=512, tta=False, use_fp16=True, val_frequency=1, val_size=768, weight_decay=1e-05, workers=6)
[09-18 09:56] - Start training
[09-18 09:56] - Model size: 19.89M
[09-18 09:56] - Loss for this run is: AdditiveAngularMarginLoss(
  (criterion): CrossEntropyLoss()
)
[09-18 09:56] - Val size: 13556
[09-18 09:56] - Train size: 55249
[09-18 09:56] - True, None, None
[09-18 09:56] - Start phase #1 from epoch 0 to epoch 30: {'ep': [0, 30], 'lr': [0.1, 0.005], 'mom': [], 'mode': 'linear'}
[09-18 09:56] - Epoch 1 | lr 0.00e+00
[09-18 10:02] - 
TimeMeter profiling. Data time: 7.90E-04s. Model time: 3.95E-01s 

[09-18 10:04] - Train loss: 39.9113 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:04] - Val   loss: 40.5791 | Acc_@1: 0.0305 | mAP@10: 0.0471 | target: 0.0388 | CMC@10: 0.1108
[09-18 10:04] - Epoch  1: best target improved from -inf to 0.0388
[09-18 10:04] - Epoch  1: best loss improved from inf to 40.5791
[09-18 10:04] - Epoch 2 | lr 9.71e-02
[09-18 10:12] - Train loss: 39.5323 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:12] - Val   loss: 40.6585 | Acc_@1: 0.0358 | mAP@10: 0.0581 | target: 0.0469 | CMC@10: 0.1361
[09-18 10:12] - Epoch  2: best target improved from 0.0388 to 0.0469
[09-18 10:12] - Epoch 3 | lr 9.39e-02
[09-18 10:20] - Train loss: 39.3669 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:20] - Val   loss: 40.7270 | Acc_@1: 0.0562 | mAP@10: 0.0917 | target: 0.0739 | CMC@10: 0.2024
[09-18 10:20] - Epoch  3: best target improved from 0.0469 to 0.0739
[09-18 10:20] - Epoch 4 | lr 9.07e-02
[09-18 10:28] - Train loss: 39.1106 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:28] - Val   loss: 40.9564 | Acc_@1: 0.1093 | mAP@10: 0.1436 | target: 0.1264 | CMC@10: 0.2835
[09-18 10:28] - Epoch  4: best target improved from 0.0739 to 0.1264
[09-18 10:28] - Epoch 5 | lr 8.76e-02
[09-18 10:36] - Train loss: 38.6933 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:36] - Val   loss: 41.0129 | Acc_@1: 0.1806 | mAP@10: 0.2172 | target: 0.1989 | CMC@10: 0.3980
[09-18 10:36] - Epoch  5: best target improved from 0.1264 to 0.1989
[09-18 10:36] - Epoch 6 | lr 8.44e-02
[09-18 10:43] - Train loss: 38.1203 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:43] - Val   loss: 41.4017 | Acc_@1: 0.2552 | mAP@10: 0.2901 | target: 0.2726 | CMC@10: 0.4908
[09-18 10:43] - Epoch  6: best target improved from 0.1989 to 0.2726
[09-18 10:43] - Epoch 7 | lr 8.12e-02
[09-18 10:51] - Train loss: 37.3568 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:51] - Val   loss: 41.6755 | Acc_@1: 0.3475 | mAP@10: 0.3810 | target: 0.3643 | CMC@10: 0.5940
[09-18 10:51] - Epoch  7: best target improved from 0.2726 to 0.3643
[09-18 10:51] - Epoch 8 | lr 7.81e-02
[09-18 10:59] - Train loss: 36.4040 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 10:59] - Val   loss: 42.0085 | Acc_@1: 0.4214 | mAP@10: 0.4441 | target: 0.4327 | CMC@10: 0.6608
[09-18 10:59] - Epoch  8: best target improved from 0.3643 to 0.4327
[09-18 10:59] - Epoch 9 | lr 7.49e-02
[09-18 11:07] - Train loss: 35.2237 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 11:07] - Val   loss: 42.8776 | Acc_@1: 0.5085 | mAP@10: 0.5272 | target: 0.5178 | CMC@10: 0.7429
[09-18 11:07] - Epoch  9: best target improved from 0.4327 to 0.5178
[09-18 11:07] - Epoch 10 | lr 7.17e-02
[09-18 11:15] - Train loss: 33.8429 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 11:15] - Val   loss: 42.9277 | Acc_@1: 0.5888 | mAP@10: 0.5984 | target: 0.5936 | CMC@10: 0.7983
[09-18 11:15] - Epoch 10: best target improved from 0.5178 to 0.5936
[09-18 11:15] - Epoch 11 | lr 6.86e-02
[09-18 11:23] - Train loss: 32.2152 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 11:23] - Val   loss: 43.5556 | Acc_@1: 0.6525 | mAP@10: 0.6548 | target: 0.6536 | CMC@10: 0.8330
[09-18 11:23] - Epoch 11: best target improved from 0.5936 to 0.6536
[09-18 11:23] - Epoch 12 | lr 6.54e-02
[09-18 11:31] - Train loss: 30.4662 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 11:31] - Val   loss: 44.6592 | Acc_@1: 0.7252 | mAP@10: 0.7152 | target: 0.7202 | CMC@10: 0.8794
[09-18 11:31] - Epoch 12: best target improved from 0.6536 to 0.7202
[09-18 11:31] - Epoch 13 | lr 6.22e-02
[09-18 11:39] - Train loss: 28.4731 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 11:39] - Val   loss: 45.2653 | Acc_@1: 0.7316 | mAP@10: 0.7231 | target: 0.7274 | CMC@10: 0.8873
[09-18 11:39] - Epoch 13: best target improved from 0.7202 to 0.7274
[09-18 11:39] - Epoch 14 | lr 5.91e-02
[09-18 11:47] - Train loss: 26.5425 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 11:47] - Val   loss: 46.1542 | Acc_@1: 0.7644 | mAP@10: 0.7632 | target: 0.7638 | CMC@10: 0.9118
[09-18 11:47] - Epoch 14: best target improved from 0.7274 to 0.7638
[09-18 11:47] - Epoch 15 | lr 5.59e-02
[09-18 11:54] - Train loss: 24.6062 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 11:54] - Val   loss: 46.5766 | Acc_@1: 0.8010 | mAP@10: 0.7888 | target: 0.7949 | CMC@10: 0.9239
[09-18 11:54] - Epoch 15: best target improved from 0.7638 to 0.7949
[09-18 11:54] - Epoch 16 | lr 5.27e-02
[09-18 12:02] - Train loss: 22.7903 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:02] - Val   loss: 47.1629 | Acc_@1: 0.8014 | mAP@10: 0.7926 | target: 0.7970 | CMC@10: 0.9306
[09-18 12:02] - Epoch 16: best target improved from 0.7949 to 0.7970
[09-18 12:02] - Epoch 17 | lr 4.96e-02
[09-18 12:10] - Train loss: 21.3639 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:10] - Val   loss: 47.6558 | Acc_@1: 0.8055 | mAP@10: 0.7983 | target: 0.8019 | CMC@10: 0.9303
[09-18 12:10] - Epoch 17: best target improved from 0.7970 to 0.8019
[09-18 12:10] - Epoch 18 | lr 4.64e-02
[09-18 12:18] - Train loss: 19.6617 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:18] - Val   loss: 47.8352 | Acc_@1: 0.8243 | mAP@10: 0.8127 | target: 0.8185 | CMC@10: 0.9352
[09-18 12:18] - Epoch 18: best target improved from 0.8019 to 0.8185
[09-18 12:18] - Epoch 19 | lr 4.32e-02
[09-18 12:26] - Train loss: 18.1200 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:26] - Val   loss: 48.8369 | Acc_@1: 0.8213 | mAP@10: 0.8154 | target: 0.8184 | CMC@10: 0.9397
[09-18 12:26] - Epoch 20 | lr 4.01e-02
[09-18 12:33] - Train loss: 16.7951 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:33] - Val   loss: 48.7190 | Acc_@1: 0.8443 | mAP@10: 0.8280 | target: 0.8362 | CMC@10: 0.9446
[09-18 12:33] - Epoch 20: best target improved from 0.8185 to 0.8362
[09-18 12:33] - Epoch 21 | lr 3.69e-02
[09-18 12:41] - Train loss: 15.4484 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:41] - Val   loss: 49.1433 | Acc_@1: 0.8379 | mAP@10: 0.8245 | target: 0.8312 | CMC@10: 0.9446
[09-18 12:41] - Epoch 22 | lr 3.37e-02
[09-18 12:49] - Train loss: 14.2386 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:49] - Val   loss: 49.7698 | Acc_@1: 0.8428 | mAP@10: 0.8278 | target: 0.8353 | CMC@10: 0.9431
[09-18 12:49] - Epoch 23 | lr 3.06e-02
[09-18 12:57] - Train loss: 13.1968 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 12:57] - Val   loss: 49.8373 | Acc_@1: 0.8462 | mAP@10: 0.8373 | target: 0.8417 | CMC@10: 0.9518
[09-18 12:57] - Epoch 23: best target improved from 0.8362 to 0.8417
[09-18 12:57] - Epoch 24 | lr 2.74e-02
[09-18 13:05] - Train loss: 12.2162 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 13:05] - Val   loss: 49.9877 | Acc_@1: 0.8492 | mAP@10: 0.8414 | target: 0.8453 | CMC@10: 0.9555
[09-18 13:05] - Epoch 24: best target improved from 0.8417 to 0.8453
[09-18 13:05] - Epoch 25 | lr 2.42e-02
[09-18 13:13] - Train loss: 11.3762 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 13:13] - Val   loss: 50.2777 | Acc_@1: 0.8515 | mAP@10: 0.8411 | target: 0.8463 | CMC@10: 0.9499
[09-18 13:13] - Epoch 25: best target improved from 0.8453 to 0.8463
[09-18 13:13] - Epoch 26 | lr 2.11e-02
[09-18 13:21] - Train loss: 10.5526 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 13:21] - Val   loss: 50.5626 | Acc_@1: 0.8424 | mAP@10: 0.8350 | target: 0.8387 | CMC@10: 0.9461
[09-18 13:21] - Epoch 27 | lr 1.79e-02
[09-18 13:29] - Train loss: 9.8496 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 13:29] - Val   loss: 50.4758 | Acc_@1: 0.8583 | mAP@10: 0.8443 | target: 0.8513 | CMC@10: 0.9536
[09-18 13:29] - Epoch 27: best target improved from 0.8463 to 0.8513
[09-18 13:29] - Epoch 28 | lr 1.47e-02
[09-18 13:37] - Train loss: 9.2389 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 13:37] - Val   loss: 50.7248 | Acc_@1: 0.8568 | mAP@10: 0.8440 | target: 0.8504 | CMC@10: 0.9529
[09-18 13:37] - Epoch 29 | lr 1.16e-02
[09-18 13:45] - Train loss: 8.7328 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 13:45] - Val   loss: 50.8091 | Acc_@1: 0.8541 | mAP@10: 0.8438 | target: 0.8489 | CMC@10: 0.9484
[09-18 13:45] - Epoch 30 | lr 8.41e-03
[09-18 13:53] - Train loss: 8.3225 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 13:53] - Val   loss: 50.7390 | Acc_@1: 0.8568 | mAP@10: 0.8440 | target: 0.8504 | CMC@10: 0.9529
[09-18 13:53] - Loading best model from previous phase
[09-18 13:53] - Start phase #2 from epoch 30 to epoch 50: {'ep': [30, 50], 'lr': [0.005, 0.0001], 'mom': [], 'mode': 'linear'}
[09-18 13:53] - Epoch 31 | lr 5.25e-03
[09-18 14:01] - Train loss: 8.9846 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:01] - Val   loss: 50.6601 | Acc_@1: 0.8590 | mAP@10: 0.8462 | target: 0.8526 | CMC@10: 0.9525
[09-18 14:01] - Epoch 31: best target improved from 0.8513 to 0.8526
[09-18 14:01] - Epoch 32 | lr 4.77e-03
[09-18 14:09] - Train loss: 8.6941 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:09] - Val   loss: 50.7904 | Acc_@1: 0.8481 | mAP@10: 0.8389 | target: 0.8435 | CMC@10: 0.9484
[09-18 14:09] - Epoch 33 | lr 4.53e-03
[09-18 14:17] - Train loss: 8.5204 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:17] - Val   loss: 50.7913 | Acc_@1: 0.8538 | mAP@10: 0.8411 | target: 0.8474 | CMC@10: 0.9499
[09-18 14:17] - Epoch 34 | lr 4.28e-03
[09-18 14:25] - Train loss: 8.3408 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:25] - Val   loss: 50.7412 | Acc_@1: 0.8620 | mAP@10: 0.8486 | target: 0.8553 | CMC@10: 0.9555
[09-18 14:25] - Epoch 34: best target improved from 0.8526 to 0.8553
[09-18 14:25] - Epoch 35 | lr 4.04e-03
[09-18 14:33] - Train loss: 8.1969 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:33] - Val   loss: 50.9150 | Acc_@1: 0.8602 | mAP@10: 0.8456 | target: 0.8529 | CMC@10: 0.9544
[09-18 14:33] - Epoch 36 | lr 3.79e-03
[09-18 14:41] - Train loss: 8.0722 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:41] - Val   loss: 50.8790 | Acc_@1: 0.8575 | mAP@10: 0.8433 | target: 0.8504 | CMC@10: 0.9502
[09-18 14:41] - Epoch 37 | lr 3.55e-03
[09-18 14:49] - Train loss: 7.9241 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:49] - Val   loss: 50.9974 | Acc_@1: 0.8553 | mAP@10: 0.8427 | target: 0.8490 | CMC@10: 0.9487
[09-18 14:49] - Epoch 38 | lr 3.30e-03
[09-18 14:57] - Train loss: 7.8385 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 14:57] - Val   loss: 51.0107 | Acc_@1: 0.8549 | mAP@10: 0.8444 | target: 0.8496 | CMC@10: 0.9525
[09-18 14:57] - Epoch 39 | lr 3.06e-03
[09-18 15:05] - Train loss: 7.7696 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 15:05] - Val   loss: 51.0651 | Acc_@1: 0.8496 | mAP@10: 0.8436 | target: 0.8466 | CMC@10: 0.9525
[09-18 15:05] - Epoch 40 | lr 2.81e-03
[09-18 15:13] - Train loss: 7.6587 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 15:13] - Val   loss: 51.0554 | Acc_@1: 0.8507 | mAP@10: 0.8395 | target: 0.8451 | CMC@10: 0.9453
[09-18 15:13] - Epoch 41 | lr 2.57e-03
[09-18 15:20] - Train loss: 7.5963 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 15:20] - Val   loss: 51.0059 | Acc_@1: 0.8504 | mAP@10: 0.8407 | target: 0.8455 | CMC@10: 0.9499
[09-18 15:20] - Epoch 42 | lr 2.32e-03
[09-18 15:28] - Train loss: 7.4840 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 15:28] - Val   loss: 51.0369 | Acc_@1: 0.8485 | mAP@10: 0.8386 | target: 0.8435 | CMC@10: 0.9465
[09-18 15:28] - Epoch 43 | lr 2.08e-03
[09-18 15:36] - Train loss: 7.4710 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 15:36] - Val   loss: 51.0815 | Acc_@1: 0.8568 | mAP@10: 0.8423 | target: 0.8495 | CMC@10: 0.9499
[09-18 15:36] - Epoch 44 | lr 1.83e-03
[09-18 15:44] - Train loss: 7.3896 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 15:44] - Val   loss: 51.1342 | Acc_@1: 0.8530 | mAP@10: 0.8413 | target: 0.8471 | CMC@10: 0.9487
[09-18 15:44] - Epoch 45 | lr 1.59e-03
[09-18 15:52] - Train loss: 7.3582 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 15:52] - Val   loss: 51.1161 | Acc_@1: 0.8579 | mAP@10: 0.8440 | target: 0.8509 | CMC@10: 0.9514
[09-18 15:52] - Epoch 46 | lr 1.34e-03
[09-18 16:00] - Train loss: 7.2777 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 16:00] - Val   loss: 51.0635 | Acc_@1: 0.8594 | mAP@10: 0.8417 | target: 0.8505 | CMC@10: 0.9510
[09-18 16:00] - Epoch 47 | lr 1.10e-03
[09-18 16:08] - Train loss: 7.2508 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 16:08] - Val   loss: 51.1155 | Acc_@1: 0.8564 | mAP@10: 0.8421 | target: 0.8492 | CMC@10: 0.9487
[09-18 16:08] - Epoch 48 | lr 8.54e-04
[09-18 16:16] - Train loss: 7.2316 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 16:16] - Val   loss: 51.1177 | Acc_@1: 0.8564 | mAP@10: 0.8422 | target: 0.8493 | CMC@10: 0.9487
[09-18 16:16] - Epoch 49 | lr 6.09e-04
[09-18 16:24] - Train loss: 7.1763 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 16:24] - Val   loss: 51.1845 | Acc_@1: 0.8579 | mAP@10: 0.8431 | target: 0.8505 | CMC@10: 0.9506
[09-18 16:24] - Epoch 50 | lr 3.64e-04
[09-18 16:32] - Train loss: 7.1890 | Acc_@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | CMC@10: 0.0000
[09-18 16:32] - Val   loss: 51.1730 | Acc_@1: 0.8564 | mAP@10: 0.8408 | target: 0.8486 | CMC@10: 0.9491
[09-18 16:32] - Loading best model from previous phase
[09-18 16:32] - Finished Training. Took: 395.62m
