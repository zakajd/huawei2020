[09-20 02:13] - Parameters used for training: Namespace(arch='genet_small', augmentation='light', batch_size=128, config_file='configs/1_genet_small.yaml', criterion='arcface', criterion_params={'out_features': 3097, 's': 80.0, 'm': 1.0}, debug=False, ema_decay=0.0, embedding_size=512, freeze_bn=False, model_params={}, name='genet_small_384_light_arcface80', optim='adamw', outdir='logs/genet_small_384_light_arcface80', phases=[{'ep': [0, 20], 'lr': [0.01, 0.0001]}], pooling='gem', resume='', root='data/interim', seed=42, size=384, tta=False, use_fp16=True, val_frequency=1, val_size=512, weight_decay=1e-05, workers=8)
[09-20 02:13] - Model size: 7.24M
[09-20 02:13] - Loss for this run is: AdditiveAngularMarginLoss(
  (criterion): CrossEntropyLoss()
)
[09-20 02:13] - Using sizes {(384, 768), (384, 512), (480, 384), (384, 384), (512, 384), (384, 576), (384, 480), (768, 384), (576, 384), (680, 384), (384, 680)} for train
[09-20 02:13] - Using sizes {(768, 512), (512, 512), (640, 512), (512, 1024), (512, 768), (1024, 512), (512, 640), (680, 512), (904, 512), (512, 904), (512, 680)} for validation
[09-20 02:13] - Val size: 16656
[09-20 02:13] - Train size: 51945
[09-20 02:13] - Start training
[09-20 02:13] - Start phase #1 from epoch 0 to epoch 20: {'ep': [0, 20], 'lr': [0.01, 0.0001], 'mom': [], 'mode': 'linear'}
[09-20 02:13] - Epoch 1 | lr 0.00e+00
[09-20 02:16] - 
TimeMeter profiling. Data time: 5.98E-04s. Model time: 2.90E-01s 

[09-20 02:16] - Train loss: 77.0543 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:16] - Val   loss: 77.2807 | Acc@1: 0.6446 | mAP@10: 0.6308 | target: 0.6377 | mAP@R: 0.5754
[09-20 02:16] - Epoch  1: best target improved from -inf to 0.6377
[09-20 02:16] - Epoch  1: best mAP@R improved from -inf to 0.5754
[09-20 02:16] - Epoch 2 | lr 9.64e-03
[09-20 02:20] - Train loss: 75.8351 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:20] - Val   loss: 78.2229 | Acc@1: 0.7822 | mAP@10: 0.7624 | target: 0.7723 | mAP@R: 0.7143
[09-20 02:20] - Epoch  2: best target improved from 0.6377 to 0.7723
[09-20 02:20] - Epoch  2: best mAP@R improved from 0.5754 to 0.7143
[09-20 02:20] - Epoch 3 | lr 9.14e-03
[09-20 02:23] - Train loss: 71.2768 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:23] - Val   loss: 80.9484 | Acc@1: 0.8439 | mAP@10: 0.8255 | target: 0.8347 | mAP@R: 0.7847
[09-20 02:23] - Epoch  3: best target improved from 0.7723 to 0.8347
[09-20 02:23] - Epoch  3: best mAP@R improved from 0.7143 to 0.7847
[09-20 02:23] - Epoch 4 | lr 8.65e-03
[09-20 02:27] - Train loss: 64.4306 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:27] - Val   loss: 84.6570 | Acc@1: 0.8536 | mAP@10: 0.8362 | target: 0.8449 | mAP@R: 0.8030
[09-20 02:27] - Epoch  4: best target improved from 0.8347 to 0.8449
[09-20 02:27] - Epoch  4: best mAP@R improved from 0.7847 to 0.8030
[09-20 02:27] - Epoch 5 | lr 8.15e-03
[09-20 02:32] - Train loss: 57.6059 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:32] - Val   loss: 86.8996 | Acc@1: 0.8836 | mAP@10: 0.8567 | target: 0.8701 | mAP@R: 0.8264
[09-20 02:32] - Epoch  5: best target improved from 0.8449 to 0.8701
[09-20 02:32] - Epoch  5: best mAP@R improved from 0.8030 to 0.8264
[09-20 02:32] - Epoch 6 | lr 7.66e-03
[09-20 02:36] - Train loss: 52.0938 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:36] - Val   loss: 88.6079 | Acc@1: 0.8801 | mAP@10: 0.8567 | target: 0.8684 | mAP@R: 0.8272
[09-20 02:36] - Epoch  6: best mAP@R improved from 0.8264 to 0.8272
[09-20 02:36] - Epoch 7 | lr 7.16e-03
[09-20 02:41] - Train loss: 47.5965 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:41] - Val   loss: 89.1384 | Acc@1: 0.8818 | mAP@10: 0.8645 | target: 0.8732 | mAP@R: 0.8343
[09-20 02:41] - Epoch  7: best target improved from 0.8701 to 0.8732
[09-20 02:41] - Epoch  7: best mAP@R improved from 0.8272 to 0.8343
[09-20 02:41] - Epoch 8 | lr 6.67e-03
[09-20 02:46] - Train loss: 43.8545 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:46] - Val   loss: 90.3011 | Acc@1: 0.8871 | mAP@10: 0.8701 | target: 0.8786 | mAP@R: 0.8418
[09-20 02:46] - Epoch  8: best target improved from 0.8732 to 0.8786
[09-20 02:46] - Epoch  8: best mAP@R improved from 0.8343 to 0.8418
[09-20 02:46] - Epoch 9 | lr 6.17e-03
[09-20 02:50] - Train loss: 40.6889 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:50] - Val   loss: 91.2141 | Acc@1: 0.8801 | mAP@10: 0.8680 | target: 0.8740 | mAP@R: 0.8396
[09-20 02:50] - Epoch 10 | lr 5.68e-03
[09-20 02:54] - Train loss: 38.0860 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:54] - Val   loss: 91.5124 | Acc@1: 0.8871 | mAP@10: 0.8698 | target: 0.8784 | mAP@R: 0.8396
[09-20 02:54] - Epoch 11 | lr 5.18e-03
[09-20 02:59] - Train loss: 35.9074 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 02:59] - Val   loss: 91.9225 | Acc@1: 0.8871 | mAP@10: 0.8753 | target: 0.8812 | mAP@R: 0.8479
[09-20 02:59] - Epoch 11: best target improved from 0.8786 to 0.8812
[09-20 02:59] - Epoch 11: best mAP@R improved from 0.8418 to 0.8479
[09-20 02:59] - Epoch 12 | lr 4.69e-03
[09-20 03:03] - Train loss: 33.9750 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:03] - Val   loss: 92.4952 | Acc@1: 0.8933 | mAP@10: 0.8754 | target: 0.8843 | mAP@R: 0.8481
[09-20 03:03] - Epoch 12: best target improved from 0.8812 to 0.8843
[09-20 03:03] - Epoch 12: best mAP@R improved from 0.8479 to 0.8481
[09-20 03:03] - Epoch 13 | lr 4.19e-03
[09-20 03:08] - Train loss: 32.3584 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:08] - Val   loss: 93.2443 | Acc@1: 0.8862 | mAP@10: 0.8688 | target: 0.8775 | mAP@R: 0.8403
[09-20 03:08] - Epoch 14 | lr 3.70e-03
[09-20 03:13] - Train loss: 31.0159 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:13] - Val   loss: 93.3650 | Acc@1: 0.8880 | mAP@10: 0.8716 | target: 0.8798 | mAP@R: 0.8428
[09-20 03:13] - Epoch 15 | lr 3.20e-03
[09-20 03:17] - Train loss: 29.8243 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:17] - Val   loss: 93.8354 | Acc@1: 0.8880 | mAP@10: 0.8760 | target: 0.8820 | mAP@R: 0.8477
[09-20 03:17] - Epoch 16 | lr 2.71e-03
[09-20 03:22] - Train loss: 28.8711 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:22] - Val   loss: 94.1851 | Acc@1: 0.8854 | mAP@10: 0.8717 | target: 0.8785 | mAP@R: 0.8455
[09-20 03:22] - Epoch 17 | lr 2.21e-03
[09-20 03:26] - Train loss: 28.0827 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:26] - Val   loss: 94.1107 | Acc@1: 0.8915 | mAP@10: 0.8752 | target: 0.8834 | mAP@R: 0.8481
[09-20 03:26] - Epoch 17: best mAP@R improved from 0.8481 to 0.8481
[09-20 03:26] - Epoch 18 | lr 1.72e-03
[09-20 03:31] - Train loss: 27.4280 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:31] - Val   loss: 94.3765 | Acc@1: 0.8898 | mAP@10: 0.8753 | target: 0.8825 | mAP@R: 0.8470
[09-20 03:31] - Epoch 19 | lr 1.22e-03
[09-20 03:35] - Train loss: 26.9476 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:35] - Val   loss: 94.2559 | Acc@1: 0.8854 | mAP@10: 0.8713 | target: 0.8783 | mAP@R: 0.8438
[09-20 03:35] - Epoch 20 | lr 7.26e-04
[09-20 03:40] - Train loss: 26.6508 | Acc@1: 0.0000 | mAP@10: 0.0000 | target: 0.0000 | mAP@R: 0.0000
[09-20 03:40] - Val   loss: 94.2674 | Acc@1: 0.8898 | mAP@10: 0.8757 | target: 0.8828 | mAP@R: 0.8491
[09-20 03:40] - Epoch 20: best mAP@R improved from 0.8481 to 0.8491
[09-20 03:40] - Loading best model from previous phase
[09-20 03:41] - Val: Acc@1 0.89330, mAP@10 0.87537, Target 0.88433, mAP@R 0.84806
[09-20 03:41] - Finished Training. Took: 88.16m
